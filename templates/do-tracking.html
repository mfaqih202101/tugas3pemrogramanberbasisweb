<div class="animate-fade-in">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h3 class="fw-bold text-dark m-0">Tracking Delivery Order</h3>
        <button class="btn-black" @click="bukaModal" aria-label="Buat DO Baru">
            <i class="fas fa-plus me-2"></i> Buat DO Baru
        </button>
    </div>

    <div class="search-container">
        <label class="fw-bold small mb-2">Cari Nomor DO</label>
        <input v-model="searchQuery" class="form-control" placeholder="Masukkan Nomor DO / Nama..." aria-label="Cari DO">
    </div>

    <div v-for="item in filteredTracking" :key="item.noDO" class="tracking-card">
        <div class="d-flex justify-content-between align-items-start border-bottom pb-3 mb-3">
            <div>
                <h5 class="fw-bold mb-1"><i class="fas fa-box me-2"></i> {{ item.noDO }}</h5>
                <div class="text-muted small">NIM: {{ item.nim }} | Nama: {{ item.nama }}</div>
            </div>
            <div class="d-flex align-items-center gap-2">
                <status-badge type="tracking" :status="item.status"></status-badge>
                <button class="btn btn-sm btn-outline-secondary" title="Cetak"><i class="fas fa-print"></i></button>
                <button class="btn btn-sm btn-outline-danger" @click="hapusDO(item)" title="Hapus"><i class="fas fa-trash"></i></button>
            </div>
        </div>

        <div class="row g-3 mb-4">
            <div class="col-md-4">
                <small class="text-muted d-block">Ekspedisi</small>
                <span class="fw-bold">{{ item.ekspedisi }}</span>
            </div>
            <div class="col-md-4">
                <small class="text-muted d-block">Paket</small>
                <span class="fw-bold">{{ item.paket }}</span>
            </div>
            <div class="col-md-4">
                <small class="text-muted d-block">Total</small>
                <span class="fw-bold">{{ formatRupiah(item.total) }}</span>
            </div>
        </div>

        <h6 class="fw-bold text-secondary">Riwayat Perjalanan</h6>
        <div class="timeline">
            <div class="timeline-item" v-for="(log, index) in item.perjalanan" :key="index">
                <div class="timeline-point"></div>
                <div class="timeline-time">{{ log.waktu }}</div>
                <div class="timeline-desc">{{ log.keterangan }}</div>
            </div>
        </div>
    </div>

    <app-modal id="modalDoForm" title="Buat Delivery Order Baru">
        <form @submit.prevent="submitDO">
            <div class="mb-3"><label class="small fw-bold">Nomor DO</label><input :value="generatedDONumber" class="form-control" disabled aria-label="No DO"></div>
            <div class="mb-3"><label class="small fw-bold">NIM</label><input v-model="form.nim" class="form-control" required aria-label="NIM"></div>
            <div class="mb-3"><label class="small fw-bold">Nama</label><input v-model="form.nama" class="form-control" required aria-label="Nama"></div>
            <div class="mb-3"><label class="small fw-bold">Paket</label><select v-model="form.paket" class="form-select" required aria-label="Paket"><option v-for="p in paketList" :value="p.kode">{{p.nama}}</option></select></div>
            <div class="mb-3"><label class="small fw-bold">Ekspedisi</label><select v-model="form.ekspedisi" class="form-select" required aria-label="Ekspedisi"><option v-for="e in pengirimanList" :value="e.nama">{{e.nama}}</option></select></div>
            <div class="text-end pt-2">
                <button type="button" class="btn btn-light me-2" data-bs-dismiss="modal">Batal</button>
                <button type="submit" class="btn btn-black">Simpan DO</button>
            </div>
        </form>
    </app-modal>
</div>